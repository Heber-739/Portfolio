"use strict";(self.webpackChunkportafolio=self.webpackChunkportafolio||[]).push([[592],{3058:(B,x,y)=>{y.d(x,{s:()=>S});var h=y(1223),F=y(655),u=(()=>{return(e=u||(u={}))[e.Up=1]="Up",e[e.Down=3]="Down",e[e.Right=6]="Right",e[e.Left=8]="Left",e[e.UpMirrored=2]="UpMirrored",e[e.DownMirrored=4]="DownMirrored",e[e.LeftMirrored=5]="LeftMirrored",e[e.RightMirrored=7]="RightMirrored",e[e.Default=0]="Default",e[e.NotJpeg=-1]="NotJpeg",e[e.NotDefined=-2]="NotDefined",u;var e})();class l{}l.getOrientation=e=>new Promise((r,n)=>{try{const s=new FileReader;s.onload=()=>{const o=new DataView(s.result);if(!o.byteLength||65496!==o.getUint16(0,!1))return r(u.NotDefined);const f=o.byteLength;let t=2;for(;t<f;){const a=o.getUint16(t,!1);if(t+=2,65505===a){if(1165519206!==o.getUint32(t+=2,!1))return r(u.NotJpeg);const g=18761===o.getUint16(t+=6,!1);t+=o.getUint32(t+4,g);const d=o.getUint16(t,g);t+=2;for(let i=0;i<d;i++)if(274===o.getUint16(t+12*i,g))return r(o.getUint16(t+12*i+8,g))}else{if(65280!=(65280&a))break;t+=o.getUint16(t,!1)}}return r(u.NotJpeg)},s.readAsArrayBuffer(e)}catch(s){return n(u.Default)}}),l.uploadFile=(e,r=!0,n=!1)=>new Promise(function(s,o){const f=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),t=/iPad|iPhone|iPod/i.test(navigator.userAgent);Promise.resolve(f||t).then(a=>a?l.generateUploadInputNative(window.document,r,n):l.generateUploadInputRenderer(e,r,n)).then(a=>{const g=a?Array.from(a):[],d=g.map(m=>l.getOrientation(m)),i=g.map(m=>l.fileToDataURL(m));let c=[];Promise.all(d).then(m=>(c=m,Promise.all(i))).then(m=>{const p=m.map((w,b)=>({image:w.dataUrl,orientation:c[b],fileName:w.fileName}));s(r?p:p[0])})}).catch(a=>o(a))}),l.fileToDataURL=e=>new Promise((r,n)=>{const s=new FileReader;s.onload=o=>{r({dataUrl:o.target.result,fileName:e.name})};try{s.readAsDataURL(e)}catch(o){n(`ngx-image-compress - probably no file have been selected: ${o}`)}}),l.generateUploadInputRenderer=(e,r=!0,n=!1)=>{let s=!1;return new Promise((o,f)=>{const t=e.createElement("input");e.setStyle(t,"display","none"),e.setProperty(t,"type","file"),e.setProperty(t,"accept","image/*"),r&&e.setProperty(t,"multiple","true"),e.listen(t,"click",a=>{a.target.value=""}),e.listen(t,"change",a=>{s=!0,o(a.target.files)}),n&&window.addEventListener("focus",()=>{setTimeout(()=>{s||f(new Error("file upload on blur - no file selected"))},300)},{once:!0}),t.click()})},l.generateUploadInputNative=(e,r=!0,n=!1)=>{let s=!1;return new Promise((o,f)=>{const t=e.createElement("input");t.id="upload-input"+new Date,t.style.display="none",t.setAttribute("type","file"),t.setAttribute("accept","image/*"),r&&t.setAttribute("multiple","true"),e.body.appendChild(t),t.addEventListener("change",()=>{s=!0,o(t.files),e.body.removeChild(e.getElementById(t.id))},{once:!0}),n&&window.addEventListener("focus",()=>{setTimeout(()=>{!s&&e.getElementById(t.id)&&(f(new Error("file upload on blur - no file selected")),e.body.removeChild(e.getElementById(t.id)))},300)},{once:!0}),t.click()})},l.compress=(e,r,n,s=50,o=50,f=0,t=0)=>new Promise(function(a,g){o/=100,s/=100;const d=new Image;d.onload=()=>{const i=n.createElement("canvas"),c=i.getContext("2d");if(!c)return g("No canvas context available");let m=d.naturalWidth,p=d.naturalHeight;if(!CSS.supports("image-orientation","from-image")&&(r===u.Right||r===u.Left)){const k=m;m=p,p=k}s=Math.min(s,f?f/m:1,t?t/p:1),i.width=m*s,i.height=p*s;const v=Math.PI/180;CSS.supports("image-orientation","from-image")||r===u.Up?c.drawImage(d,0,0,i.width,i.height):r===u.Right?(c.save(),c.rotate(90*v),c.translate(0,-i.width),c.drawImage(d,0,0,i.height,i.width),c.restore()):r===u.Left?(c.save(),c.rotate(-90*v),c.translate(-i.width,0),c.drawImage(d,0,0,i.height,i.width),c.restore()):r===u.Down?(c.save(),c.rotate(180*v),c.translate(-i.width,-i.height),c.drawImage(d,0,0,i.width,i.height),c.restore()):c.drawImage(d,0,0,i.width,i.height);const P=e.substr(5,e.split(";")[0].length-5),L=i.toDataURL(P,o);a(L)},d.onerror=i=>g(i),d.src=e}),l.byteCount=e=>encodeURI(e).split(/%..|./).length-1,l.getImageMaxSize=(e,r,n,s=!1)=>(0,F.mG)(void 0,void 0,void 0,function*(){const f=g=>(g/1024/1024).toFixed(2);r&&console.debug("NgxImageCompress - Opening upload window");let a,t=yield l.uploadFile(n,!1,s);for(let g=0;g<10;g++){const d=l.byteCount(t.image);a=yield l.compress(t.image,t.orientation,n,50,100);const i=l.byteCount(a);if(console.debug("NgxImageCompress -","Compression from",f(d),"MB to",f(i),"MB"),i>=d)throw 0===g?(r&&console.debug("NgxImageCompress -","File can't be reduced at all - returning the original",f(d),"MB large"),t.image):(r&&console.debug("NgxImageCompress -","File can't be reduced more - returning the best we can, which is ",f(d),"MB large"),t.image);if(i<1024*e*1024)return r&&console.debug("NgxImageCompress -","Here your file",f(i),"MB large"),a;if(9===g)throw r&&console.debug("NgxImageCompress -","File can't reach the desired size after",10,"tries. Returning file ",f(d),"MB large"),t.image;r&&console.debug("NgxImageCompress -","Reached",f(i),"MB large. Trying another time after",g+1,"times"),t.image=a}throw r&&console.debug("NgxImageCompress - Unexpected error"),""});let M=(()=>{class e{constructor(n){this.DOC_ORIENTATION=u,this.render=n.createRenderer(null,null)}byteCount(n){return l.byteCount(n)}getOrientation(n){return l.getOrientation(n)}uploadFile(){return l.uploadFile(this.render,!1)}uploadMultipleFiles(){return l.uploadFile(this.render,!0)}uploadFileOrReject(){return l.uploadFile(this.render,!1,!0)}uploadMultipleFilesOrReject(){return l.uploadFile(this.render,!0,!0)}compressFile(n,s,o=50,f=50,t=0,a=0){return l.compress(n,s,this.render,o,f,t,a)}uploadAndGetImageWithMaxSize(n=1,s=!1,o=!1){return l.getImageMaxSize(n,s,this.render,o)}}return e.\u0275fac=function(n){return new(n||e)(h.LFG(h.FYo))},e.\u0275prov=h.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),S=(()=>{class e{constructor(n){this.ngxC=n}compress(){return new Promise(n=>{this.ngxC.uploadFile().then(({image:s,orientation:o})=>{this.ngxC.compressFile(s,o,100,50).then(f=>fetch(f).then(a=>a.blob()).then(a=>{const g=new FileReader;g.onload=()=>n(String(g.result)),g.readAsDataURL(a)}))})})}}return e.\u0275fac=function(n){return new(n||e)(h.LFG(M))},e.\u0275prov=h.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);